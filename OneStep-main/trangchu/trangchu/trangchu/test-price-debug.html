<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Price Debug - S·ª≠a l·ªói hi·ªÉn th·ªã gi√° 0</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-title {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .test-step {
            margin: 15px 0;
            padding: 10px;
            background: #f8f9fa;
            border-left: 4px solid #007bff;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .warning {
            color: #ffc107;
            font-weight: bold;
        }
        .info {
            color: #17a2b8;
        }
        .code-block {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            margin: 10px 0;
            border: 1px solid #e9ecef;
        }
        .debug-example {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .price-example {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üîß Test Price Debug - S·ª≠a l·ªói hi·ªÉn th·ªã gi√° 0</h1>
    
    <div class="test-section">
        <h2 class="test-title">üêõ V·∫•n ƒë·ªÅ ƒë√£ ph√°t hi·ªán</h2>
        
        <div class="test-step">
            <h3 class="error">‚ùå L·ªói: Gi√° hi·ªÉn th·ªã 0 ‚Ç´</h3>
            <p>‚Ä¢ S·∫£n ph·∫©m trong gi·ªè h√†ng hi·ªÉn th·ªã gi√° 0 ‚Ç´</p>
            <p>‚Ä¢ T·∫°m t√≠nh: 0 ‚Ç´</p>
            <p>‚Ä¢ Ch·ªâ c√≥ ph√≠ v·∫≠n chuy·ªÉn: 50.000 ‚Ç´</p>
            <p>‚Ä¢ T·ªïng c·ªông: 50.000 ‚Ç´</p>
        </div>
        
        <div class="test-step">
            <h3 class="info">üîç Nguy√™n nh√¢n c√≥ th·ªÉ:</h3>
            <p>‚Ä¢ API kh√¥ng tr·∫£ v·ªÅ gi√° ƒë√∫ng</p>
            <p>‚Ä¢ L·ªói trong vi·ªác mapping d·ªØ li·ªáu t·ª´ API</p>
            <p>‚Ä¢ Fallback logic kh√¥ng ho·∫°t ƒë·ªông</p>
            <p>‚Ä¢ Cart items kh√¥ng c√≥ gi√° ban ƒë·∫ßu</p>
        </div>
    </div>
    
    <div class="test-section">
        <h2 class="test-title">üîß C√°c s·ª≠a ƒë·ªïi ƒë√£ th·ª±c hi·ªán</h2>
        
        <div class="test-step">
            <h3>‚úÖ 1. C·∫≠p nh·∫≠t ProductService.js</h3>
            <div class="code-block">
// Th√™m fallback cho gi√°
price: firstDetail.giaTien || item.price || 0
            </div>
        </div>
        
        <div class="test-step">
            <h3>‚úÖ 2. C·∫≠p nh·∫≠t Checkout.vue - displayCartItems</h3>
            <div class="code-block">
displayCartItems() {
  if (this.updatedCartItems.length > 0) {
    // Ki·ªÉm tra v√† ƒë·∫£m b·∫£o gi√° kh√¥ng b·ªã 0
    return this.updatedCartItems.map(item => ({
      ...item,
      price: item.price || item.giaTien || 0
    }))
  }
  return this.cartItems
}
            </div>
        </div>
        
        <div class="test-step">
            <h3>‚úÖ 3. Th√™m debug logging</h3>
            <div class="code-block">
updatedCartTotal() {
  const total = this.displayCartItems.reduce((total, item) => {
    const itemPrice = item.price || item.giaTien || 0
    console.log(`üí∞ Item ${item.name}: price=${item.price}, giaTien=${item.giaTien}, quantity=${item.quantity}`)
    return total + (itemPrice * item.quantity)
  }, 0)
  console.log(`üí∞ Total cart: ${total}`)
  return total
}
            </div>
        </div>
        
        <div class="test-step">
            <h3>‚úÖ 4. Th√™m ph∆∞∆°ng th·ª©c debugAndFixPrices</h3>
            <div class="code-block">
debugAndFixPrices() {
  // N·∫øu t·∫•t c·∫£ gi√° ƒë·ªÅu l√† 0, s·ª≠ d·ª•ng gi√° g·ªëc t·ª´ cart
  const hasZeroPrices = this.displayCartItems.every(item => (item.price || item.giaTien || 0) === 0)
  if (hasZeroPrices && this.cartItems.length > 0) {
    this.updatedCartItems = this.cartItems.map(item => ({
      ...item,
      price: item.price || 0
    }))
  }
}
            </div>
        </div>
        
        <div class="test-step">
            <h3>‚úÖ 5. Th√™m UI debug button</h3>
            <div class="debug-example">
                <p><strong>Hi·ªÉn th·ªã khi:</strong> updatedCartTotal === 0 && cartItems.length > 0</p>
                <p><strong>N·ªôi dung:</strong> "Gi√° s·∫£n ph·∫©m kh√¥ng hi·ªÉn th·ªã ƒë√∫ng" + Button "S·ª≠a gi√°"</p>
                <p><strong>M√†u:</strong> V√†ng (#fff3cd)</p>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2 class="test-title">üß™ C√°ch test v√† debug</h2>
        
        <div class="test-step">
            <h3>B∆∞·ªõc 1: Ki·ªÉm tra Console Logs</h3>
            <div class="code-block">
// M·ªü Developer Tools ‚Üí Console
// T√¨m c√°c log sau:
üîÑ C·∫≠p nh·∫≠t gi√° s·∫£n ph·∫©m trong gi·ªè h√†ng...
üì° L·∫•y chi ti·∫øt s·∫£n ph·∫©m cho sanPhamId: [ID]
‚úÖ T√¨m th·∫•y [X] chi ti·∫øt s·∫£n ph·∫©m
üí∞ Item [Name]: price=[price], giaTien=[giaTien], quantity=[qty]
üí∞ Total cart: [total]
üîç Debug cart items:
            </div>
        </div>
        
        <div class="test-step">
            <h3>B∆∞·ªõc 2: Ki·ªÉm tra Network Requests</h3>
            <p>‚Ä¢ M·ªü Developer Tools ‚Üí Network</p>
            <p>‚Ä¢ Reload trang checkout</p>
            <p>‚Ä¢ Ki·ªÉm tra request ƒë·∫øn API chi-tiet-san-pham</p>
            <p>‚Ä¢ Xem response c√≥ ch·ª©a giaTien kh√¥ng</p>
        </div>
        
        <div class="test-step">
            <h3>B∆∞·ªõc 3: Ki·ªÉm tra Vuex Store</h3>
            <p>‚Ä¢ M·ªü Vuex DevTools</p>
            <p>‚Ä¢ Ki·ªÉm tra cart store state</p>
            <p>‚Ä¢ Xem cartItems c√≥ gi√° ban ƒë·∫ßu kh√¥ng</p>
        </div>
        
        <div class="test-step">
            <h3>B∆∞·ªõc 4: S·ª≠ d·ª•ng Debug Button</h3>
            <p>‚Ä¢ N·∫øu th·∫•y th√¥ng b√°o "Gi√° s·∫£n ph·∫©m kh√¥ng hi·ªÉn th·ªã ƒë√∫ng"</p>
            <p>‚Ä¢ Click button "S·ª≠a gi√°"</p>
            <p>‚Ä¢ Ki·ªÉm tra console logs</p>
            <p>‚Ä¢ Xem gi√° c√≥ ƒë∆∞·ª£c s·ª≠a kh√¥ng</p>
        </div>
    </div>
    
    <div class="test-section">
        <h2 class="test-title">üìä C√°c tr∆∞·ªùng h·ª£p test</h2>
        
        <div class="test-step">
            <h3>Test Case 1: API tr·∫£ v·ªÅ gi√° ƒë√∫ng</h3>
            <div class="price-example">
                <p><strong>K·∫øt qu·∫£ mong ƒë·ª£i:</strong> Gi√° hi·ªÉn th·ªã ƒë√∫ng t·ª´ API</p>
                <p><strong>Console:</strong> ‚úÖ T√¨m th·∫•y chi ti·∫øt s·∫£n ph·∫©m</p>
                <p><strong>UI:</strong> Kh√¥ng c√≥ debug message</p>
            </div>
        </div>
        
        <div class="test-step">
            <h3>Test Case 2: API tr·∫£ v·ªÅ gi√° 0</h3>
            <div class="debug-example">
                <p><strong>K·∫øt qu·∫£ mong ƒë·ª£i:</strong> S·ª≠ d·ª•ng gi√° t·ª´ cart g·ªëc</p>
                <p><strong>Console:</strong> ‚ö†Ô∏è T·∫•t c·∫£ gi√° ƒë·ªÅu l√† 0, s·ª≠ d·ª•ng gi√° g·ªëc t·ª´ cart</p>
                <p><strong>UI:</strong> Hi·ªÉn th·ªã debug message</p>
            </div>
        </div>
        
        <div class="test-step">
            <h3>Test Case 3: API l·ªói</h3>
            <div class="debug-example">
                <p><strong>K·∫øt qu·∫£ mong ƒë·ª£i:</strong> S·ª≠ d·ª•ng gi√° t·ª´ cart g·ªëc</p>
                <p><strong>Console:</strong> ‚ùå L·ªói c·∫≠p nh·∫≠t gi√° s·∫£n ph·∫©m</p>
                <p><strong>UI:</strong> Hi·ªÉn th·ªã error message + button "Th·ª≠ l·∫°i"</p>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2 class="test-title">üéØ K·∫øt qu·∫£ mong ƒë·ª£i</h2>
        
        <div class="test-step">
            <h3 class="success">‚úÖ Th√†nh c√¥ng</h3>
            <p>‚Ä¢ Gi√° s·∫£n ph·∫©m hi·ªÉn th·ªã ƒë√∫ng (kh√¥ng ph·∫£i 0 ‚Ç´)</p>
            <p>‚Ä¢ T·∫°m t√≠nh hi·ªÉn th·ªã t·ªïng gi√° s·∫£n ph·∫©m</p>
            <p>‚Ä¢ T·ªïng c·ªông = T·∫°m t√≠nh + Ph√≠ v·∫≠n chuy·ªÉn</p>
            <p>‚Ä¢ Console logs hi·ªÉn th·ªã th√¥ng tin debug</p>
        </div>
        
        <div class="test-step">
            <h3 class="warning">‚ö†Ô∏è N·∫øu v·∫´n c√≥ l·ªói</h3>
            <p>‚Ä¢ Ki·ªÉm tra cart items c√≥ gi√° ban ƒë·∫ßu kh√¥ng</p>
            <p>‚Ä¢ Ki·ªÉm tra API response c√≥ ƒë√∫ng format kh√¥ng</p>
            <p>‚Ä¢ Ki·ªÉm tra network connection</p>
            <p>‚Ä¢ S·ª≠ d·ª•ng debug button ƒë·ªÉ s·ª≠a gi√°</p>
        </div>
    </div>
    
    <div class="test-section">
        <h2 class="test-title">üîç Debug Commands</h2>
        
        <div class="test-step">
            <h3>Console Commands ƒë·ªÉ debug:</h3>
            <div class="code-block">
// Ki·ªÉm tra cart items
console.log('Cart Items:', this.$store.state.cart.items)

// Ki·ªÉm tra updated cart items
console.log('Updated Cart Items:', this.updatedCartItems)

// Ki·ªÉm tra display cart items
console.log('Display Cart Items:', this.displayCartItems)

// Ki·ªÉm tra cart total
console.log('Cart Total:', this.$store.getters['cart/cartTotal'])

// Ki·ªÉm tra updated cart total
console.log('Updated Cart Total:', this.updatedCartTotal)

// G·ªçi debug function
this.debugAndFixPrices()
            </div>
        </div>
    </div>
    
    <script>
        // Test functions
        function testPriceDebug() {
            console.log('üîß Testing Price Debug...')
            
            // Mock cart items
            const mockCartItems = [
                {
                    id: 1,
                    name: 'Gi√†y Nike Court Vision Mid',
                    price: 1800000,
                    quantity: 1,
                    image: '/images/shoe-1.jpg'
                }
            ]
            
            // Mock API response
            const mockApiResponse = {
                giaTien: 1800000,
                tienGiamGia: 0,
                soLuongTon: 10
            }
            
            // Test price calculation
            const total = mockCartItems.reduce((sum, item) => {
                const itemPrice = item.price || 0
                console.log(`üí∞ Item ${item.name}: price=${item.price}, quantity=${item.quantity}, total=${itemPrice * item.quantity}`)
                return sum + (itemPrice * item.quantity)
            }, 0)
            
            console.log(`üí∞ Total cart: ${total}`)
            console.log('‚úÖ Price debug test completed!')
        }
        
        // Run test on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Price Debug Test Page Loaded')
            testPriceDebug()
        })
    </script>
</body>
</html>